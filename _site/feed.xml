<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="3.8.5">Jekyll</generator><link href="http://localhost:4000/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" /><updated>2019-06-06T19:36:24+07:00</updated><id>http://localhost:4000/feed.xml</id><title type="html">Dried Jack</title><entry><title type="html">Nh·ªØng ki·∫øn th·ª©c c∆° b·∫£n Rails Migration</title><link href="http://localhost:4000/rails/2019/06/06/nhung-kien-thuc-co-ban-rails-migration.html" rel="alternate" type="text/html" title="Nh·ªØng ki·∫øn th·ª©c c∆° b·∫£n Rails Migration" /><published>2019-06-06T00:00:00+07:00</published><updated>2019-06-06T00:00:00+07:00</updated><id>http://localhost:4000/rails/2019/06/06/nhung-kien-thuc-co-ban-rails-migration</id><content type="html" xml:base="http://localhost:4000/rails/2019/06/06/nhung-kien-thuc-co-ban-rails-migration.html">&lt;h2 id=&quot;rails-migrations-l√†-g√¨-t·∫°i-sao-l·∫°i-c√≥-n√≥-v√†-d√πng-n√≥-nh∆∞-th·∫ø-n√†o&quot;&gt;Rails migrations l√† g√¨, t·∫°i sao l·∫°i c√≥ n√≥ v√† d√πng n√≥ nh∆∞ th·∫ø n√†o?&lt;/h2&gt;

&lt;p&gt;Theo nh∆∞ trang h∆∞·ªõng d·∫´n ch√≠nh th·ª©c c√≥ gi·ªõi thi·ªáu th√¨ migration l√† c√°ch ti·ªán l·ªùi ƒë·ªÉ thay ƒë·ªïi database (db) schema d·ªÖ d√†ng v√†
 th·ªëng nh·∫•t theo th·ªùi gian. V·ªõi m·ªói s·ª± thay ƒë·ªïi trong c·∫•u tr√∫c db t·ª´ ƒë·∫ßu ƒë·∫øn cu·ªëi ƒë·ªÅu ƒë∆∞·ª£c ph·∫£n √°nh h·∫øt trong migration.
 T·ª´ng file l√† t·ª´ng phi√™n b·∫£n, t·ª´ng l√°t c·∫Øt th·ªùi gian c·ªßa db. V√¨ migration d√πng ruby DSL n√™n kh√¥ng c·∫ßn thi·∫øt ph·∫£i t·ª± vi·∫øt SQL,
 gi√∫p cho c√°c thay ƒë·ªïi c≈©ng nh∆∞ schema ƒë·ªôc l·∫≠p v·ªõi database.&lt;/p&gt;

&lt;p&gt;V·ªõi nh·ªØng ƒë·ªãnh nghƒ©a nh∆∞ tr√™n th√¨ m√¨nh nghƒ© vi·ªác c√≥ migration gi√∫p √≠ch r·∫•t nhi·ªÅu cho vi·ªác qu·∫£n l√Ω c·∫•u tr√∫c db, h·ª£p t√°c l√†m
 vi·ªác cho nhi·ªÅu l·∫≠p tr√¨nh vi√™n trong c√πng m·ªôt nh√≥m, kh√¥ng ph·∫£i m√≥ nhi·ªÅu t·ªõi SQL v√† db. Trong nh·ªØng d·ª± √°n m√¨nh l√†m th√¨
 vi·ªác ƒëi·ªÅu ch·ªânh c·∫•u tr√∫c db hi·∫øm khi ph·∫£i t·ª± vi·∫øt tay, ruby l√† ng√¥n ng·ªØ th√¢n thi·ªán n·ªØa n√™n d·ªÖ ƒë·ªçc d·ªÖ hi·ªÉu v√† d·ªÖ chia s·∫ª v·ªõi nh√≥m.
 ƒê√≥ l√† v√†i ƒëi·ªÉm theo kinh nghi·ªám m√¨nh th·∫•y hay v√† m√¨nh nghƒ© ƒë·ªÉ th·ªÉ hi·ªán n√≥ r√µ n√©t nh·∫•t l√† th√¥ng qua v√≠ d·ª• v√† th·ª±c h√†nh.&lt;/p&gt;

&lt;p&gt;Migration nh∆∞ ki·ªÉu theo th·ªùi gian t·ªõi m·ªói phi√™n b·∫£n migration l√† ƒëang ph·∫£n √°nh ƒë√∫ng t√¨nh tr·∫°ng hi·ªán t·∫°i c·ªßa schema t·ª´
 version ƒë√≥ tr·ªü v·ªÅ tr∆∞·ªõc. M·ªói version ƒë∆∞·ª£c ph·∫£n √°nh qua nhi·ªÅu ch·ª©c nƒÉng nh∆∞ t·∫°o b·∫£ng, x√≥a b·∫£ng, th√™m c·ªôt, x√≥a c·ªôt,
 th√™m index, constraint,‚Ä¶ C√πng v·ªõi vi·ªác ch·∫°y migration AR (&lt;em&gt;ActiveRecord&lt;/em&gt;) c≈©ng ƒë·ªìng th·ªùi update file &lt;code class=&quot;highlighter-rouge&quot;&gt;db/schema.rb&lt;/code&gt;
 ph·∫£n √°nh c·∫•u tr√∫c c·ªßa database.&lt;/p&gt;

&lt;h2 id=&quot;trong-th·ª±c-ti·ªÖn&quot;&gt;Trong th·ª±c ti·ªÖn&lt;/h2&gt;

&lt;h3 id=&quot;t·∫°o-migration&quot;&gt;T·∫°o migration&lt;/h3&gt;

&lt;p&gt;T√™n file migration tu√¢n th·ªß theo qui t·∫Øc &lt;em&gt;s·ªë_t√™n_migration.rb&lt;/em&gt;. C√°c file migration ƒë∆∞·ª£c s·∫Øp x·∫øp theo t√™n file t·ª´ nh·ªè ƒë·∫øn l·ªõn.
 L·ªánh &lt;code class=&quot;highlighter-rouge&quot;&gt;rails db:migrate&lt;/code&gt; ƒë·ªÉ migrate db. Khi migrate, rails s·∫Ω d·ª±a v√†o th·ª© t·ª± c√°c file ƒë·ªÉ th·ª±c hi·ªán migration, n·∫øu sai th·ª© t·ª±
 s·∫Ω x·∫£y ra nhi·ªÅu ƒë·ª•ng ch·∫°m nghi√™m tr·ªçng ph√°t sinh l·ªói v√¨ th·∫ø rails c√≥ h·ªó tr·ª£ cho ta v√†i l·ªánh t·∫°o migration k√®m theo con s·ªë ·ªü
 ƒë·∫ßu file ƒë∆∞·ª£c sinh ra t·ª´ th·ªùi gian theo UTC, v√≠ d·ª• &lt;em&gt;20190511031142_create_posts.rb&lt;/em&gt; ƒë∆∞·ª£c t·∫°o b·∫±ng l·ªánh&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; rails g migration CreatePosts
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Trong file ƒë∆∞·ª£c t·∫°o ra s·∫Ω ch·ª©a ƒëo·∫°n code nh∆∞ n√†y (ƒëo·∫°n comment l√† t·ª± vi·∫øt)&lt;/p&gt;
&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;CreatePosts&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;ActiveRecord&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Migration&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;6.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;change&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;create_table&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:posts&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
      &lt;span class=&quot;c1&quot;&gt;# t.references :user, null: false, foreign_key: true&lt;/span&gt;
      &lt;span class=&quot;c1&quot;&gt;# t.string :title&lt;/span&gt;
      &lt;span class=&quot;c1&quot;&gt;# t.text :body&lt;/span&gt;

      &lt;span class=&quot;c1&quot;&gt;# t.timestamps&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;L·ªánh t·∫°o migration c√≤n h·ªó tr·ª£ ƒë·ªãnh nghƒ©a tr∆∞·ªõc c√°c c·ªôt n·ªØa, v√≠ d·ª• nh∆∞&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;rails g AddCategoryToPosts category:references views:integer
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;M·ªôt l·ªánh kh√°c kh√° h·ªØu √≠ch ƒë√≥ l√† l·ªánh t·∫°o model&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;rails generate model Product name:string description:text
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;t·∫°o migration nh∆∞ n√†y&lt;/p&gt;
&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;CreateProducts&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;ActiveRecord&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Migration&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;5.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;change&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;create_table&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:products&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:name&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;text&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:description&lt;/span&gt;

      &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;timestamps&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;vi·∫øt-v√†-ch·∫°y-migration&quot;&gt;Vi·∫øt v√† ch·∫°y migration&lt;/h3&gt;

&lt;p&gt;ƒê·ªÉ h·ªó tr·ª£ vi·∫øt migration, rails cung c·∫•p r·∫•t nhi·ªÅu h√†m v√≠ d·ª• nh∆∞ &lt;code class=&quot;highlighter-rouge&quot;&gt;create_table, add_column, remove_column,...&lt;/code&gt;
 c√°c b·∫°n c√≥ th·ªÉ tham kh·∫£o ·ªü nh·ªØng link sau:
 &lt;a href=&quot;https://edgeapi.rubyonrails.org/classes/ActiveRecord/ConnectionAdapters/SchemaStatements.html&quot;&gt;ActiveRecord::ConnectionAdapters::SchemaStatements&lt;/a&gt;,
 &lt;a href=&quot;https://edgeapi.rubyonrails.org/classes/ActiveRecord/ConnectionAdapters/TableDefinition.html&quot;&gt;ActiveRecord::ConnectionAdapters::TableDefinition&lt;/a&gt;,
 &lt;a href=&quot;https://edgeapi.rubyonrails.org/classes/ActiveRecord/ConnectionAdapters/Table.html&quot;&gt;ActiveRecord::ConnectionAdapters::Table&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ƒêi·ªÉm ƒë·∫∑c bi·ªát quan tr·ªçng ·ªü ƒë√¢y ƒë√≥ l√† migration cho ph√©p ta &lt;em&gt;quay ng∆∞·ª£c v·ªÅ qu√° kh·ª©&lt;/em&gt; c√≥ nghƒ©a l√† quay tr·ªü l·∫°i
 phi√™n b·∫£n tr∆∞·ªõc ƒë√≥ c·ªßa db, l·ªánh ƒë·ªÉ th·ª±c thi l√† &lt;code class=&quot;highlighter-rouge&quot;&gt;rails db:rollback&lt;/code&gt;, h·ªó tr·ª£ th√™m bi·∫øn &lt;code class=&quot;highlighter-rouge&quot;&gt;STEP=s·ªë&lt;/code&gt; ƒë·ªÉ quay ng∆∞·ª£c
 l·∫°i &lt;em&gt;s·ªë&lt;/em&gt; verion c·ªßa migration. L·ªánh n√†y l√† m·ªôt c√°ch vi·∫øt ƒë·ªÉ h·ªó tr·ª£ l·ªánh &lt;code class=&quot;highlighter-rouge&quot;&gt;rails db:migration VERSION=s·ªë_ƒë·∫ßu_file&lt;/code&gt;,
 c√πng v·ªõi ƒë√≥ l√† l·ªánh &lt;code class=&quot;highlighter-rouge&quot;&gt;rails db:migrate:redo STEP=s·ªë&lt;/code&gt; ƒë·ªÉ rollback v√† migrate l·∫°i.&lt;/p&gt;

&lt;p&gt;ƒê·ªÉ c√≥ th·ªÉ roll back th√¨ rails ph·∫£i bi·∫øt rollback nh∆∞ th·∫ø n√†o. ƒê·ªëi v·ªõi h√†m change trong migration, khi g·ªçi
h√†m trong h√†m n√†y th√¨ rails s·∫Ω t·ª± ƒë·ªông rollback n·∫øu b·∫£n th√¢n h√†m ƒë∆∞·ª£c g·ªçi ƒë√≥ c√≥ th·ªÉ rollback ƒë∆∞·ª£c, n·∫øu kh√¥ng
s·∫Ω raise l·ªói &lt;code class=&quot;highlighter-rouge&quot;&gt;ActiveRecord::IrreversibleMigration&lt;/code&gt;. Khi ƒë√≥ ta ph·∫£i cung c·∫•p rails th√¥ng tin ƒë·ªÉ rollback l·∫°i
b·∫±ng h√†m &lt;code class=&quot;highlighter-rouge&quot;&gt;reversible&lt;/code&gt;, v√≠ d·ª•&lt;/p&gt;
&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ExampleMigration&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;ActiveRecord&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Migration&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;5.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;change&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;create_table&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:distributors&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:zipcode&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;reversible&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dir&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;dir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;up&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# add a CHECK constraint&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;execute&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;-&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;SQL&lt;/span&gt;&lt;span class=&quot;sh&quot;&gt;
          ALTER TABLE distributors
            ADD CONSTRAINT zipchk
              CHECK (char_length(zipcode) = 5) NO INHERIT;
&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;        SQL&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;dir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;down&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;execute&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;-&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;SQL&lt;/span&gt;&lt;span class=&quot;sh&quot;&gt;
          ALTER TABLE distributors
            DROP CONSTRAINT zipchk
&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;        SQL&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;add_column&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:users&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:home_page_url&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:string&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;rename_column&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:users&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:email&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:email_address&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Ho·∫∑c kh√¥ng ta c√≥ th·ªÉ d√πng c√°ch c≈© c·ªßa rails l√† ƒë·ªãnh nghƒ©a hai h√†m &lt;code class=&quot;highlighter-rouge&quot;&gt;up, down&lt;/code&gt; ƒë·ªÉ n√≥i r√µ cho rails bi·∫øt migrate
 l√†m g√¨ v√† rollback l√†m g√¨.&lt;/p&gt;
&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ExampleMigration&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;ActiveRecord&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Migration&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;5.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;up&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;create_table&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:distributors&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:zipcode&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# add a CHECK constraint&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;execute&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;-&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;SQL&lt;/span&gt;&lt;span class=&quot;sh&quot;&gt;
      ALTER TABLE distributors
        ADD CONSTRAINT zipchk
        CHECK (char_length(zipcode) = 5);
&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;    SQL&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;add_column&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:users&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:home_page_url&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:string&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;rename_column&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:users&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:email&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:email_address&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;down&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;rename_column&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:users&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:email_address&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:email&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;remove_column&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:users&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:home_page_url&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;execute&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;-&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;SQL&lt;/span&gt;&lt;span class=&quot;sh&quot;&gt;
      ALTER TABLE distributors
        DROP CONSTRAINT zipchk
&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;    SQL&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;drop_table&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:distributors&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;M·ªôt h√†m kh√°c c≈©ng kh√° hay d√πng ƒë·ªÉ rollback trong migration ƒë√≥ l√† h√†m &lt;code class=&quot;highlighter-rouge&quot;&gt;revert&lt;/code&gt;, khi g·ªçi h√†m n√†y n√≥ s·∫Ω revert
 l·∫°i ƒë√∫ng nh·ªØng g√¨ ta cung c·∫•p (block ho·∫∑c class) gi·ªëng v·ªõi l·ªánh &lt;code class=&quot;highlighter-rouge&quot;&gt;rails db:rollback&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
&lt;span class=&quot;nb&quot;&gt;require_relative&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'20121212123456_example_migration'&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;FixupExampleMigration&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;ActiveRecord&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Migration&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;5.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;change&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;revert&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;ExampleMigration&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;create_table&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:apples&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:variety&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;File tr√™n c≈©ng c√≥ th·ªÉ ƒë∆∞·ª£c vi·∫øt l·∫°i m√† kh√¥ng d√πng &lt;code class=&quot;highlighter-rouge&quot;&gt;revert&lt;/code&gt; nh∆∞ng ta ph·∫£i ƒë·ªÉ √Ω nhi·ªÅu th·ª© h∆°n nh∆∞ l√† ƒë·ªïi l·∫°i
 th·ª© t·ª± c√°c l·ªánh trong h√†m &lt;code class=&quot;highlighter-rouge&quot;&gt;change&lt;/code&gt;, ƒë·ªïi ng∆∞·ª£c l·∫°i &lt;code class=&quot;highlighter-rouge&quot;&gt;up&lt;/code&gt; v√† &lt;code class=&quot;highlighter-rouge&quot;&gt;down&lt;/code&gt;, chuy·ªÉn &lt;code class=&quot;highlighter-rouge&quot;&gt;create_table&lt;/code&gt; th√†nh &lt;code class=&quot;highlighter-rouge&quot;&gt;drop_table&lt;/code&gt;,
 r·∫Øc r·ªëi h∆°n.&lt;/p&gt;

&lt;h2 id=&quot;t·ªïng-k·∫øt&quot;&gt;T·ªïng k·∫øt&lt;/h2&gt;

&lt;p&gt;Tr√™n l√† m·ªôt v√†i ƒëi·ªÉm c·∫ßn bi·∫øt tr∆∞·ªõc nh·∫•t v·ªÅ rails migration, nh∆∞ l√† c√¥ng d·ª•ng c√°ch vi·∫øt, c√°c l·ªánh h·ªØu √≠ch,
 rollback,‚Ä¶ g·ªçi l√† c√°c l·ªánh hay d√πng. Ngo√†i ra c√≤n m·ªôt v√†i th·ª© hay ho v·ªÅ migration nh∆∞ ch·∫°y migration cho
 c√°c m√¥i tr∆∞·ªùng kh√°c nhau, ch·∫°y phi√™n b·∫£n c·ªë ƒë·ªãnh migration, thay ƒë·ªïi output cho migration, c·ªôt modifier,‚Ä¶
 s·∫Ω d√†nh cho c√°c b·∫°n t√¨m hi·ªÉu s√¢u h∆°n.&lt;/p&gt;

&lt;p&gt;N·∫øu th·∫•y c√≥ g√¨ g√≥p √Ω th√¨ c·ª© mail li√™n h·ªá ho·∫∑c contribute nh√©.&lt;/p&gt;

&lt;p&gt;R·∫•t nhi·ªÅu y√™u th∆∞∆°ng üíñ&lt;/p&gt;</content><author><name></name></author><summary type="html">Rails migrations l√† g√¨, t·∫°i sao l·∫°i c√≥ n√≥ v√† d√πng n√≥ nh∆∞ th·∫ø n√†o? Theo nh∆∞ trang h∆∞·ªõng d·∫´n ch√≠nh th·ª©c c√≥ gi·ªõi thi·ªáu th√¨ migration l√† c√°ch ti·ªán l·ªùi ƒë·ªÉ thay ƒë·ªïi database (db) schema d·ªÖ d√†ng v√† th·ªëng nh·∫•t theo th·ªùi gian. V·ªõi m·ªói s·ª± thay ƒë·ªïi trong c·∫•u tr√∫c db t·ª´ ƒë·∫ßu ƒë·∫øn cu·ªëi ƒë·ªÅu ƒë∆∞·ª£c ph·∫£n √°nh h·∫øt trong migration. T·ª´ng file l√† t·ª´ng phi√™n b·∫£n, t·ª´ng l√°t c·∫Øt th·ªùi gian c·ªßa db. V√¨ migration d√πng ruby DSL n√™n kh√¥ng c·∫ßn thi·∫øt ph·∫£i t·ª± vi·∫øt SQL, gi√∫p cho c√°c thay ƒë·ªïi c≈©ng nh∆∞ schema ƒë·ªôc l·∫≠p v·ªõi database. V·ªõi nh·ªØng ƒë·ªãnh nghƒ©a nh∆∞ tr√™n th√¨ m√¨nh nghƒ© vi·ªác c√≥ migration gi√∫p √≠ch r·∫•t nhi·ªÅu cho vi·ªác qu·∫£n l√Ω c·∫•u tr√∫c db, h·ª£p t√°c l√†m vi·ªác cho nhi·ªÅu l·∫≠p tr√¨nh vi√™n trong c√πng m·ªôt nh√≥m, kh√¥ng ph·∫£i m√≥ nhi·ªÅu t·ªõi SQL v√† db. Trong nh·ªØng d·ª± √°n m√¨nh l√†m th√¨ vi·ªác ƒëi·ªÅu ch·ªânh c·∫•u tr√∫c db hi·∫øm khi ph·∫£i t·ª± vi·∫øt tay, ruby l√† ng√¥n ng·ªØ th√¢n thi·ªán n·ªØa n√™n d·ªÖ ƒë·ªçc d·ªÖ hi·ªÉu v√† d·ªÖ chia s·∫ª v·ªõi nh√≥m. ƒê√≥ l√† v√†i ƒëi·ªÉm theo kinh nghi·ªám m√¨nh th·∫•y hay v√† m√¨nh nghƒ© ƒë·ªÉ th·ªÉ hi·ªán n√≥ r√µ n√©t nh·∫•t l√† th√¥ng qua v√≠ d·ª• v√† th·ª±c h√†nh. Migration nh∆∞ ki·ªÉu theo th·ªùi gian t·ªõi m·ªói phi√™n b·∫£n migration l√† ƒëang ph·∫£n √°nh ƒë√∫ng t√¨nh tr·∫°ng hi·ªán t·∫°i c·ªßa schema t·ª´ version ƒë√≥ tr·ªü v·ªÅ tr∆∞·ªõc. M·ªói version ƒë∆∞·ª£c ph·∫£n √°nh qua nhi·ªÅu ch·ª©c nƒÉng nh∆∞ t·∫°o b·∫£ng, x√≥a b·∫£ng, th√™m c·ªôt, x√≥a c·ªôt, th√™m index, constraint,‚Ä¶ C√πng v·ªõi vi·ªác ch·∫°y migration AR (ActiveRecord) c≈©ng ƒë·ªìng th·ªùi update file db/schema.rb ph·∫£n √°nh c·∫•u tr√∫c c·ªßa database. Trong th·ª±c ti·ªÖn T·∫°o migration T√™n file migration tu√¢n th·ªß theo qui t·∫Øc s·ªë_t√™n_migration.rb. C√°c file migration ƒë∆∞·ª£c s·∫Øp x·∫øp theo t√™n file t·ª´ nh·ªè ƒë·∫øn l·ªõn. L·ªánh rails db:migrate ƒë·ªÉ migrate db. Khi migrate, rails s·∫Ω d·ª±a v√†o th·ª© t·ª± c√°c file ƒë·ªÉ th·ª±c hi·ªán migration, n·∫øu sai th·ª© t·ª± s·∫Ω x·∫£y ra nhi·ªÅu ƒë·ª•ng ch·∫°m nghi√™m tr·ªçng ph√°t sinh l·ªói v√¨ th·∫ø rails c√≥ h·ªó tr·ª£ cho ta v√†i l·ªánh t·∫°o migration k√®m theo con s·ªë ·ªü ƒë·∫ßu file ƒë∆∞·ª£c sinh ra t·ª´ th·ªùi gian theo UTC, v√≠ d·ª• 20190511031142_create_posts.rb ƒë∆∞·ª£c t·∫°o b·∫±ng l·ªánh rails g migration CreatePosts Trong file ƒë∆∞·ª£c t·∫°o ra s·∫Ω ch·ª©a ƒëo·∫°n code nh∆∞ n√†y (ƒëo·∫°n comment l√† t·ª± vi·∫øt) class CreatePosts &amp;lt; ActiveRecord::Migration[6.0] def change create_table :posts do |t| # t.references :user, null: false, foreign_key: true # t.string :title # t.text :body # t.timestamps end end end L·ªánh t·∫°o migration c√≤n h·ªó tr·ª£ ƒë·ªãnh nghƒ©a tr∆∞·ªõc c√°c c·ªôt n·ªØa, v√≠ d·ª• nh∆∞ rails g AddCategoryToPosts category:references views:integer M·ªôt l·ªánh kh√°c kh√° h·ªØu √≠ch ƒë√≥ l√† l·ªánh t·∫°o model rails generate model Product name:string description:text t·∫°o migration nh∆∞ n√†y class CreateProducts &amp;lt; ActiveRecord::Migration[5.0] def change create_table :products do |t| t.string :name t.text :description t.timestamps end end end Vi·∫øt v√† ch·∫°y migration ƒê·ªÉ h·ªó tr·ª£ vi·∫øt migration, rails cung c·∫•p r·∫•t nhi·ªÅu h√†m v√≠ d·ª• nh∆∞ create_table, add_column, remove_column,... c√°c b·∫°n c√≥ th·ªÉ tham kh·∫£o ·ªü nh·ªØng link sau: ActiveRecord::ConnectionAdapters::SchemaStatements, ActiveRecord::ConnectionAdapters::TableDefinition, ActiveRecord::ConnectionAdapters::Table ƒêi·ªÉm ƒë·∫∑c bi·ªát quan tr·ªçng ·ªü ƒë√¢y ƒë√≥ l√† migration cho ph√©p ta quay ng∆∞·ª£c v·ªÅ qu√° kh·ª© c√≥ nghƒ©a l√† quay tr·ªü l·∫°i phi√™n b·∫£n tr∆∞·ªõc ƒë√≥ c·ªßa db, l·ªánh ƒë·ªÉ th·ª±c thi l√† rails db:rollback, h·ªó tr·ª£ th√™m bi·∫øn STEP=s·ªë ƒë·ªÉ quay ng∆∞·ª£c l·∫°i s·ªë verion c·ªßa migration. L·ªánh n√†y l√† m·ªôt c√°ch vi·∫øt ƒë·ªÉ h·ªó tr·ª£ l·ªánh rails db:migration VERSION=s·ªë_ƒë·∫ßu_file, c√πng v·ªõi ƒë√≥ l√† l·ªánh rails db:migrate:redo STEP=s·ªë ƒë·ªÉ rollback v√† migrate l·∫°i. ƒê·ªÉ c√≥ th·ªÉ roll back th√¨ rails ph·∫£i bi·∫øt rollback nh∆∞ th·∫ø n√†o. ƒê·ªëi v·ªõi h√†m change trong migration, khi g·ªçi h√†m trong h√†m n√†y th√¨ rails s·∫Ω t·ª± ƒë·ªông rollback n·∫øu b·∫£n th√¢n h√†m ƒë∆∞·ª£c g·ªçi ƒë√≥ c√≥ th·ªÉ rollback ƒë∆∞·ª£c, n·∫øu kh√¥ng s·∫Ω raise l·ªói ActiveRecord::IrreversibleMigration. Khi ƒë√≥ ta ph·∫£i cung c·∫•p rails th√¥ng tin ƒë·ªÉ rollback l·∫°i b·∫±ng h√†m reversible, v√≠ d·ª• class ExampleMigration &amp;lt; ActiveRecord::Migration[5.0] def change create_table :distributors do |t| t.string :zipcode end reversible do |dir| dir.up do # add a CHECK constraint execute &amp;lt;&amp;lt;-SQL ALTER TABLE distributors ADD CONSTRAINT zipchk CHECK (char_length(zipcode) = 5) NO INHERIT; SQL end dir.down do execute &amp;lt;&amp;lt;-SQL ALTER TABLE distributors DROP CONSTRAINT zipchk SQL end end add_column :users, :home_page_url, :string rename_column :users, :email, :email_address end end Ho·∫∑c kh√¥ng ta c√≥ th·ªÉ d√πng c√°ch c≈© c·ªßa rails l√† ƒë·ªãnh nghƒ©a hai h√†m up, down ƒë·ªÉ n√≥i r√µ cho rails bi·∫øt migrate l√†m g√¨ v√† rollback l√†m g√¨. class ExampleMigration &amp;lt; ActiveRecord::Migration[5.0] def up create_table :distributors do |t| t.string :zipcode end # add a CHECK constraint execute &amp;lt;&amp;lt;-SQL ALTER TABLE distributors ADD CONSTRAINT zipchk CHECK (char_length(zipcode) = 5); SQL add_column :users, :home_page_url, :string rename_column :users, :email, :email_address end def down rename_column :users, :email_address, :email remove_column :users, :home_page_url execute &amp;lt;&amp;lt;-SQL ALTER TABLE distributors DROP CONSTRAINT zipchk SQL drop_table :distributors end end M·ªôt h√†m kh√°c c≈©ng kh√° hay d√πng ƒë·ªÉ rollback trong migration ƒë√≥ l√† h√†m revert, khi g·ªçi h√†m n√†y n√≥ s·∫Ω revert l·∫°i ƒë√∫ng nh·ªØng g√¨ ta cung c·∫•p (block ho·∫∑c class) gi·ªëng v·ªõi l·ªánh rails db:rollback require_relative '20121212123456_example_migration' class FixupExampleMigration &amp;lt; ActiveRecord::Migration[5.0] def change revert ExampleMigration create_table(:apples) do |t| t.string :variety end end end File tr√™n c≈©ng c√≥ th·ªÉ ƒë∆∞·ª£c vi·∫øt l·∫°i m√† kh√¥ng d√πng revert nh∆∞ng ta ph·∫£i ƒë·ªÉ √Ω nhi·ªÅu th·ª© h∆°n nh∆∞ l√† ƒë·ªïi l·∫°i th·ª© t·ª± c√°c l·ªánh trong h√†m change, ƒë·ªïi ng∆∞·ª£c l·∫°i up v√† down, chuy·ªÉn create_table th√†nh drop_table, r·∫Øc r·ªëi h∆°n. T·ªïng k·∫øt Tr√™n l√† m·ªôt v√†i ƒëi·ªÉm c·∫ßn bi·∫øt tr∆∞·ªõc nh·∫•t v·ªÅ rails migration, nh∆∞ l√† c√¥ng d·ª•ng c√°ch vi·∫øt, c√°c l·ªánh h·ªØu √≠ch, rollback,‚Ä¶ g·ªçi l√† c√°c l·ªánh hay d√πng. Ngo√†i ra c√≤n m·ªôt v√†i th·ª© hay ho v·ªÅ migration nh∆∞ ch·∫°y migration cho c√°c m√¥i tr∆∞·ªùng kh√°c nhau, ch·∫°y phi√™n b·∫£n c·ªë ƒë·ªãnh migration, thay ƒë·ªïi output cho migration, c·ªôt modifier,‚Ä¶ s·∫Ω d√†nh cho c√°c b·∫°n t√¨m hi·ªÉu s√¢u h∆°n. N·∫øu th·∫•y c√≥ g√¨ g√≥p √Ω th√¨ c·ª© mail li√™n h·ªá ho·∫∑c contribute nh√©. R·∫•t nhi·ªÅu y√™u th∆∞∆°ng üíñ</summary></entry><entry><title type="html">Chuy·ªÉn t·ª´ gi√¢y sang ƒë·ªãnh d·∫°ng hh:mm:ss</title><link href="http://localhost:4000/rails/2019/01/19/chuyen-tu-giay-sang-dinh-dang-hhmmss.html" rel="alternate" type="text/html" title="Chuy·ªÉn t·ª´ gi√¢y sang ƒë·ªãnh d·∫°ng hh:mm:ss" /><published>2019-01-19T00:00:00+07:00</published><updated>2019-01-19T00:00:00+07:00</updated><id>http://localhost:4000/rails/2019/01/19/chuyen-tu-giay-sang-dinh-dang-hhmmss</id><content type="html" xml:base="http://localhost:4000/rails/2019/01/19/chuyen-tu-giay-sang-dinh-dang-hhmmss.html">&lt;p&gt;&lt;em&gt;C√≥ nh·ªØng tr∆∞·ªùng h·ª£p ta c√≥ s·ªë li·ªáu th·ªùi gian l√† m·ªôt s·ªë c√≥ ƒë∆°n v·ªã th·ªùi gian ƒë·ªÉ thu·∫≠n ti·ªán t√≠nh to√°n trong c√°c b√†i to√°n ph√¢n t√≠ch, th·ªëng k√™ nh∆∞ t√≠nh t·ªïng, trung b√¨nh th·ªùi gian, ‚Ä¶ Nh∆∞ng khi d√πng th·ªÉ hi·ªán l√™n m√†n h√¨nh m√† ƒë√≠ch ƒë·∫øn l√† ng∆∞·ªùi d√πng th√¨ c·∫ßn ph·∫£i ƒë·ªãnh d·∫°ng l∆∞·ª£ng th·ªùi gian ƒë√≥ theo ki·ªÉu m√† ng∆∞·ªùi d√πng quen h√¨nh dung v·ªÅ th·ªùi gian, v√≠ d·ª• nh∆∞ &lt;strong&gt;95:05:27&lt;/strong&gt; l√† 95 ti·∫øng 5 ph√∫t 27 gi√¢y ch·∫≥ng h·∫°n. B√†i vi·∫øt h√¥m nay l√† ƒë·ªÉ n√≥i v·ªÅ vi·ªác chuy·ªÉn t·ª´ s·ªë gi√¢y sang ƒë·ªãnh d·∫°ng n√†y c·ªông v·ªõi vi·ªác t·∫°i sao l·∫°i vi·∫øt v·ªÅ n√≥.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;√ù t∆∞·ªüng vi·∫øt b√†i n√†y ƒë·∫øn t·ª´ th·ª±c t·∫ø trong c√¥ng vi·ªác, mu·ªën hi·ªÉn th·ªã tr·ª±c quan th·ªùi gian l√™n m√†n h√¨nh th·ªùi gian ng∆∞·ªùi d√πng tr√™n trang web. V·ªõi ƒë·∫ßu v√†o l√† s·ªë gi√¢y. Th√¨ khi g·∫∑p task m·ªõi, nh∆∞ m·ªôt th√≥i quen c·ªßa l√≠nh m·ªõi, m√¨nh m√≤ l√™n google ƒë·ªÉ t√¨m c√°ch l√†m. M·ªôt v√†i b√†i th·∫£o lu·∫≠n tr√™n &lt;em&gt;Stackoverflow&lt;/em&gt; c√≥ n√≥i v·ªÅ v·∫•n ƒë·ªÅ n√†y, c√°ch m√† h·ªç d√πng l√† t·∫°o m·ªôt ƒë·ªëi t∆∞·ª£ng thu·ªôc l·ªõp &lt;code class=&quot;highlighter-rouge&quot;&gt;Time&lt;/code&gt; v·ªõi th·ªùi gian t·ª´ s·ªë gi√¢y c·ªßa m√¨nh. Nh∆∞ng h·∫°n ch·∫ø c·ªßa n√≥ l√† ch·ªâ ƒë√∫ng v·ªõi th·ªùi gian trong m·ªôt ng√†y, n·∫øu s·ªë gi√¢y l·ªõn h∆°n s·ªë gi√¢y c·ªßa m·ªôt ng√†y th√¨ s·ªë gi·ªù c·ªßa ng√†y b·ªã l·ªë ƒë√≥ b·ªã c·∫Øt m·∫•t.&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;no&quot;&gt;Time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;at&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seconds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;utc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;strftime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'%H:%M:%S'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# V·ªõi seconds t·ª´ 0 t·ªõi (86400 - 1) th√¨ k·∫øt qu·∫£ ƒë√∫ng&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# --&amp;gt; 53244s: &quot;14:47:24&quot;&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# V·ªõi seconds l·ªõn h∆°n gi√° tr·ªã m·ªôt ng√†y th√¨ kh√¥ng ƒë√∫ng nh∆∞ mong mu·ªën&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# --&amp;gt; 200000s: &quot;07:33:20&quot; (thay v√¨ &quot;55:33:20&quot;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Th·∫ø n√™n m√¨nh dao k√©o l·∫°i theo ki·ªÉu n·∫øu s·ªë gi√¢y l·ªõn h∆°n m·ªôt ng√†y th√¨ s·∫Ω l·∫•y s·ªë gi·ªù tr·ªôi c·ªông v·ªõi s·ªë gi·ªù theo h√†m c≈© t√≠nh t·ª´ s·ªë gi√¢y sau khi ƒë√£ tr·ª´ ra s·ªë gi·ªù tr·ªôi ·∫•y, sau ƒë√≥ gh√©p l·∫°i v·ªõi ƒëu√¥i ph√∫t v√† gi√¢y.&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;hms_style&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seconds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;hms&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;at&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seconds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;utc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;strftime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'%H:%M:%S'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;days&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;seconds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Constant&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;SECONDS_IN_DAY&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hms&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;days&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;zero?&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;h&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hms&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;':'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;h&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;to_i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;days&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;24&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# hms_style(200000) --&amp;gt; &quot;55:33:20&quot; Bingo!&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Yeah, th·∫ø l√† xong, ƒë√£ ho√†n th√†nh m·ªôt ch·ª©c nƒÉng ƒë∆°n gi·∫£n, push code v√† ch·ªù review th√¥i.&lt;/p&gt;

&lt;p&gt;‚Ä¶&lt;/p&gt;

&lt;p&gt;M·ªôt ng√†y l√†m vi·ªác tr√¥i qua, t·ªëi v·ªÅ c√°i suy nghƒ© v·ªÅ ch·ª©c nƒÉng ƒë∆°n gi·∫£n ·∫•y v·∫©n v∆° trong ƒë·∫ßu. T·∫°i sao khi ·∫≠p v√¥ l√†m m√¨nh kh√¥ng ch·ªãu suy nghƒ© v·ªÅ n√≥ tr∆∞·ªõc m√† l·∫°i bay ƒëi h·ªèi ng∆∞·ªùi kh√°c nh∆∞ th·∫ø. Th·∫ø th√¨ m√¨nh c√≥ t∆∞ duy ƒë∆∞·ª£c ch√∫t n√†o kh√¥ng, c√≥ h·ªçc ƒë∆∞·ª£c c√°ch gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ kh√¥ng, hay ch·ªâ h·ªçc ƒë∆∞·ª£c c√°ch ƒÉn c·∫Øp v√† ƒë·∫°o nh√°i √Ω t∆∞·ªüng. Th·∫ø l√† m√¨nh quy·∫øt ƒë·ªãnh ng·ªìi xu·ªëng v√† suy nghƒ© l·∫°i v·ªÅ n√≥.&lt;/p&gt;

&lt;p&gt;M√¨nh c·∫£m nh·∫≠n ƒë√¢y ƒë∆°n thu·∫ßn ch·ªâ l√† x·ª≠ l√Ω s·ªë v√† chuy·ªÉn v·ªÅ ki·ªÉu ch·ªØ. D√πng t·ªõi l·ªõp &lt;code class=&quot;highlighter-rouge&quot;&gt;Time&lt;/code&gt;Ôªø ch·ªâ l√† m·ªôt b∆∞·ªõc d√πng s·∫µn nh·ªØng th·ª© c√≥ v·∫ª l√† ƒë√∫ng th√¥i, v·ªõi m√¨nh c≈©ng ch·∫£ r√µ b√™n d∆∞·ªõi c√°i h√†m ƒë√≥ th·ª±c hi·ªán nh·ªØng g√¨ n·ªØa, li·ªáu l√†m nh∆∞ th·∫ø performance c√≥ ·ªïn kh√¥ng v√† t·∫°i sao l·∫°i li√™n quan ƒë·∫øn l·ªõp &lt;code class=&quot;highlighter-rouge&quot;&gt;Time&lt;/code&gt;c∆° ch·ª©.&lt;/p&gt;

&lt;p&gt;Nh∆∞ n√†y, v·ªõi s·ªë gi√¢y ƒë√≥, m√¨nh c√≥ t√≠nh ra ƒë∆∞·ª£c ph√∫t v·ªõi gi·ªù kh√¥ng. ƒê∆∞·ª£c, b·∫±ng c√°ch chia n√≥ cho 60 (s·ªë gi√¢y c·ªßa m·ªôt ph√∫t) ƒë∆∞·ª£c ph·∫ßn nguy√™n c·ªßa th∆∞∆°ng l√† s·ªë ph√∫t, ph·∫ßn d∆∞ ra ch√≠nh l√† s·ªë gi√¢y. S·ªë gi√¢y kh√¥ng c·∫ßn ph·∫£i x·ª≠ l√Ω n·ªØa n√™n s·∫Ω l√† ph·∫ßn gi√¢y c·ªßa k·∫øt qu·∫£. S·ªë ph√∫t ƒë√≥ c√≥ th·ªÉ l·ªõn h∆°n 60, v·∫≠y th√¨ ta chia ti·∫øp cho 60 (s·ªë ph√∫t c·ªßa m·ªôt gi·ªù) t∆∞∆°ng t·ª± nh∆∞ tr∆∞·ªõc ƒë·ªÉ c√≥ ƒë∆∞·ª£c s·ªë gi·ªù v√† s·ªë ph√∫t tr·ªìi ra. Gi·ªù v√† ph√∫t n√†y ch√≠nh l√† k·∫øt qu·∫£ m√¨nh mu·ªën.&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;hms_style&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sec&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sec&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;divmod&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;60&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;h&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;divmod&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;60&lt;/span&gt;

  &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;two_digits&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;h&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;two_digits&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;two_digits&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;kp&quot;&gt;private&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Chuy·ªÉn t·ª´ m·ªôt ch·ªØ s·ªë sang hai ch·ªØ s·ªë&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;two_digits&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;number&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;s1&quot;&gt;'%02i'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;number&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Yeah, ƒë∆°n gi·∫£n h∆°n r·ªìi. M√¨nh ƒë√£ c√≥ th·ªÉ t·ª± suy nghƒ© v√† t·ª± gi·∫£i quy·∫øt b√†i to√°n r·ªìi.&lt;/p&gt;

&lt;p&gt;Th√™m n·ªØa, khi d√πng benchmark ƒë·ªÉ ƒëo th√¨ h√†m m·ªõi n√†y nhanh h∆°n h√†m c≈© r·∫•t nhi·ªÅu. Ahihi. ü§©&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/hms-bench.png&quot; alt=&quot;HMS benchmark&quot; class=&quot;center-image&quot; /&gt;&lt;/p&gt;

&lt;p&gt;C√°m ∆°n ƒë√£ ƒë·ªçc b√†i, c√≥ g√¨ th√¨ tham gia b√¨nh lu·∫≠n cho vui h√©n.&lt;/p&gt;</content><author><name></name></author><summary type="html">C√≥ nh·ªØng tr∆∞·ªùng h·ª£p ta c√≥ s·ªë li·ªáu th·ªùi gian l√† m·ªôt s·ªë c√≥ ƒë∆°n v·ªã th·ªùi gian ƒë·ªÉ thu·∫≠n ti·ªán t√≠nh to√°n trong c√°c b√†i to√°n ph√¢n t√≠ch, th·ªëng k√™ nh∆∞ t√≠nh t·ªïng, trung b√¨nh th·ªùi gian, ‚Ä¶ Nh∆∞ng khi d√πng th·ªÉ hi·ªán l√™n m√†n h√¨nh m√† ƒë√≠ch ƒë·∫øn l√† ng∆∞·ªùi d√πng th√¨ c·∫ßn ph·∫£i ƒë·ªãnh d·∫°ng l∆∞·ª£ng th·ªùi gian ƒë√≥ theo ki·ªÉu m√† ng∆∞·ªùi d√πng quen h√¨nh dung v·ªÅ th·ªùi gian, v√≠ d·ª• nh∆∞ 95:05:27 l√† 95 ti·∫øng 5 ph√∫t 27 gi√¢y ch·∫≥ng h·∫°n. B√†i vi·∫øt h√¥m nay l√† ƒë·ªÉ n√≥i v·ªÅ vi·ªác chuy·ªÉn t·ª´ s·ªë gi√¢y sang ƒë·ªãnh d·∫°ng n√†y c·ªông v·ªõi vi·ªác t·∫°i sao l·∫°i vi·∫øt v·ªÅ n√≥. √ù t∆∞·ªüng vi·∫øt b√†i n√†y ƒë·∫øn t·ª´ th·ª±c t·∫ø trong c√¥ng vi·ªác, mu·ªën hi·ªÉn th·ªã tr·ª±c quan th·ªùi gian l√™n m√†n h√¨nh th·ªùi gian ng∆∞·ªùi d√πng tr√™n trang web. V·ªõi ƒë·∫ßu v√†o l√† s·ªë gi√¢y. Th√¨ khi g·∫∑p task m·ªõi, nh∆∞ m·ªôt th√≥i quen c·ªßa l√≠nh m·ªõi, m√¨nh m√≤ l√™n google ƒë·ªÉ t√¨m c√°ch l√†m. M·ªôt v√†i b√†i th·∫£o lu·∫≠n tr√™n Stackoverflow c√≥ n√≥i v·ªÅ v·∫•n ƒë·ªÅ n√†y, c√°ch m√† h·ªç d√πng l√† t·∫°o m·ªôt ƒë·ªëi t∆∞·ª£ng thu·ªôc l·ªõp Time v·ªõi th·ªùi gian t·ª´ s·ªë gi√¢y c·ªßa m√¨nh. Nh∆∞ng h·∫°n ch·∫ø c·ªßa n√≥ l√† ch·ªâ ƒë√∫ng v·ªõi th·ªùi gian trong m·ªôt ng√†y, n·∫øu s·ªë gi√¢y l·ªõn h∆°n s·ªë gi√¢y c·ªßa m·ªôt ng√†y th√¨ s·ªë gi·ªù c·ªßa ng√†y b·ªã l·ªë ƒë√≥ b·ªã c·∫Øt m·∫•t. Time.at(seconds).utc.strftime('%H:%M:%S') # V·ªõi seconds t·ª´ 0 t·ªõi (86400 - 1) th√¨ k·∫øt qu·∫£ ƒë√∫ng # --&amp;gt; 53244s: &quot;14:47:24&quot; # V·ªõi seconds l·ªõn h∆°n gi√° tr·ªã m·ªôt ng√†y th√¨ kh√¥ng ƒë√∫ng nh∆∞ mong mu·ªën # --&amp;gt; 200000s: &quot;07:33:20&quot; (thay v√¨ &quot;55:33:20&quot;) Th·∫ø n√™n m√¨nh dao k√©o l·∫°i theo ki·ªÉu n·∫øu s·ªë gi√¢y l·ªõn h∆°n m·ªôt ng√†y th√¨ s·∫Ω l·∫•y s·ªë gi·ªù tr·ªôi c·ªông v·ªõi s·ªë gi·ªù theo h√†m c≈© t√≠nh t·ª´ s·ªë gi√¢y sau khi ƒë√£ tr·ª´ ra s·ªë gi·ªù tr·ªôi ·∫•y, sau ƒë√≥ gh√©p l·∫°i v·ªõi ƒëu√¥i ph√∫t v√† gi√¢y. def hms_style(seconds) hms = Time.at(seconds).utc.strftime('%H:%M:%S') days = seconds / Constant::SECONDS_IN_DAY return hms if days.zero? h, m, s = hms.split(':') &quot;#{h.to_i + days * 24}:#{m}:#{s}&quot; end # hms_style(200000) --&amp;gt; &quot;55:33:20&quot; Bingo! Yeah, th·∫ø l√† xong, ƒë√£ ho√†n th√†nh m·ªôt ch·ª©c nƒÉng ƒë∆°n gi·∫£n, push code v√† ch·ªù review th√¥i. ‚Ä¶ M·ªôt ng√†y l√†m vi·ªác tr√¥i qua, t·ªëi v·ªÅ c√°i suy nghƒ© v·ªÅ ch·ª©c nƒÉng ƒë∆°n gi·∫£n ·∫•y v·∫©n v∆° trong ƒë·∫ßu. T·∫°i sao khi ·∫≠p v√¥ l√†m m√¨nh kh√¥ng ch·ªãu suy nghƒ© v·ªÅ n√≥ tr∆∞·ªõc m√† l·∫°i bay ƒëi h·ªèi ng∆∞·ªùi kh√°c nh∆∞ th·∫ø. Th·∫ø th√¨ m√¨nh c√≥ t∆∞ duy ƒë∆∞·ª£c ch√∫t n√†o kh√¥ng, c√≥ h·ªçc ƒë∆∞·ª£c c√°ch gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ kh√¥ng, hay ch·ªâ h·ªçc ƒë∆∞·ª£c c√°ch ƒÉn c·∫Øp v√† ƒë·∫°o nh√°i √Ω t∆∞·ªüng. Th·∫ø l√† m√¨nh quy·∫øt ƒë·ªãnh ng·ªìi xu·ªëng v√† suy nghƒ© l·∫°i v·ªÅ n√≥. M√¨nh c·∫£m nh·∫≠n ƒë√¢y ƒë∆°n thu·∫ßn ch·ªâ l√† x·ª≠ l√Ω s·ªë v√† chuy·ªÉn v·ªÅ ki·ªÉu ch·ªØ. D√πng t·ªõi l·ªõp TimeÔªø ch·ªâ l√† m·ªôt b∆∞·ªõc d√πng s·∫µn nh·ªØng th·ª© c√≥ v·∫ª l√† ƒë√∫ng th√¥i, v·ªõi m√¨nh c≈©ng ch·∫£ r√µ b√™n d∆∞·ªõi c√°i h√†m ƒë√≥ th·ª±c hi·ªán nh·ªØng g√¨ n·ªØa, li·ªáu l√†m nh∆∞ th·∫ø performance c√≥ ·ªïn kh√¥ng v√† t·∫°i sao l·∫°i li√™n quan ƒë·∫øn l·ªõp Timec∆° ch·ª©. Nh∆∞ n√†y, v·ªõi s·ªë gi√¢y ƒë√≥, m√¨nh c√≥ t√≠nh ra ƒë∆∞·ª£c ph√∫t v·ªõi gi·ªù kh√¥ng. ƒê∆∞·ª£c, b·∫±ng c√°ch chia n√≥ cho 60 (s·ªë gi√¢y c·ªßa m·ªôt ph√∫t) ƒë∆∞·ª£c ph·∫ßn nguy√™n c·ªßa th∆∞∆°ng l√† s·ªë ph√∫t, ph·∫ßn d∆∞ ra ch√≠nh l√† s·ªë gi√¢y. S·ªë gi√¢y kh√¥ng c·∫ßn ph·∫£i x·ª≠ l√Ω n·ªØa n√™n s·∫Ω l√† ph·∫ßn gi√¢y c·ªßa k·∫øt qu·∫£. S·ªë ph√∫t ƒë√≥ c√≥ th·ªÉ l·ªõn h∆°n 60, v·∫≠y th√¨ ta chia ti·∫øp cho 60 (s·ªë ph√∫t c·ªßa m·ªôt gi·ªù) t∆∞∆°ng t·ª± nh∆∞ tr∆∞·ªõc ƒë·ªÉ c√≥ ƒë∆∞·ª£c s·ªë gi·ªù v√† s·ªë ph√∫t tr·ªìi ra. Gi·ªù v√† ph√∫t n√†y ch√≠nh l√† k·∫øt qu·∫£ m√¨nh mu·ªën. def hms_style(sec) min, s = sec.divmod 60 h, m = min.divmod 60 &quot;#{two_digits(h)}:#{two_digits(m)}:#{two_digits(s)}&quot; end private # Chuy·ªÉn t·ª´ m·ªôt ch·ªØ s·ªë sang hai ch·ªØ s·ªë def two_digits(number) '%02i' % number end Yeah, ƒë∆°n gi·∫£n h∆°n r·ªìi. M√¨nh ƒë√£ c√≥ th·ªÉ t·ª± suy nghƒ© v√† t·ª± gi·∫£i quy·∫øt b√†i to√°n r·ªìi. Th√™m n·ªØa, khi d√πng benchmark ƒë·ªÉ ƒëo th√¨ h√†m m·ªõi n√†y nhanh h∆°n h√†m c≈© r·∫•t nhi·ªÅu. Ahihi. ü§© C√°m ∆°n ƒë√£ ƒë·ªçc b√†i, c√≥ g√¨ th√¨ tham gia b√¨nh lu·∫≠n cho vui h√©n.</summary></entry></feed>